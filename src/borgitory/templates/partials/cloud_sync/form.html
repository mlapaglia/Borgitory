<!-- Create/Edit Cloud Sync Configuration -->
<div class="border dark:border-gray-600 rounded-lg p-4">
    <h3 class="font-medium text-gray-900 dark:text-gray-100 mb-3">
        {% if config %}
            Edit Cloud Sync Location
        {% else %}
            Add Cloud Sync Location
        {% endif %}
    </h3>
    <form {% if config %}hx-put="/api/cloud-sync/{{ config.id }}"{% else %}hx-post="/api/cloud-sync/"{% endif %}
          hx-target="#cloud-sync-status"
          class="space-y-4"
          id="{% if config %}cloud-sync-edit-form{% else %}cloud-sync-form{% endif %}">
        <div>
            <label class="block text-sm font-medium text-gray-900 dark:text-gray-100">Name</label>
            <input type="text"
                   name="name"
                   required
                   value="{{ config.name if config else '' }}"
                   placeholder="{% if not config %}My Sync Location{% endif %}"
                   class="input-modern mt-1">
        </div>
        <div>
            <label class="block text-sm font-medium text-gray-900 dark:text-gray-100">
                Provider
            </label>
            <select name="provider"
                    id="{% if config %}provider-select-edit{% else %}provider-select{% endif %}"
                    class="select-modern w-full"
                    hx-get="/api/cloud-sync/provider-fields"
                    hx-target="#{% if config %}provider-fields-container-edit{% else %}provider-fields-container{% endif %}"
                    hx-trigger="change"
                    hx-swap="innerHTML"
                    hx-include="this"
                    {% if config %}hx-vals='{"mode": "edit"}'{% endif %}>
                <option value="">Select Provider</option>
                {% for provider in supported_providers %}
                    <option value="{{ provider.value }}"
                            {% if config and config.provider == provider.value %}selected{% endif %}>{{ provider.label }}
                    </option>
                {% endfor %}
            </select>
        </div>
        <!-- Dynamic Provider Fields Container -->
        <div id="{% if config %}provider-fields-container-edit{% else %}provider-fields-container{% endif %}"
             {% if not config %}
             hx-get="/api/cloud-sync/provider-fields"
             hx-trigger="load"
             hx-swap="innerHTML"
             {% endif %}>
            {% if config and provider_template %}
                {% include provider_template %}
                <div class="flex space-x-2 mt-4">
                    <button type="submit"
                            id="update-button"
                            class="flex-1 bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700">
                        {{ submit_text }}
                    </button>
                    <button type="button"
                            hx-get="/api/cloud-sync/form"
                            hx-target="#cloud-sync-form-container"
                            hx-swap="innerHTML"
                            class="px-4 py-2 bg-gray-500 text-white rounded-md hover:bg-gray-600">
                        Cancel
                    </button>
                </div>
            {% endif %}
        </div>
    </form>
    <div id="cloud-sync-status" class="mt-4"></div>
</div>

